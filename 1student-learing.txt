



# Student Learning Platform - Complete Project Documentation

## Project Overview

**Name:** LearnAI - Student Learning Platform**Purpose:** An AI-powered e-learning platform that monitors student engagement through webcam-based face detection, tracks video progress, and provides interactive quizzes with MCQ and coding challenges.

---

## Tech Stack

### Core Framework

- **Next.js 16** (App Router, React 19.2)
- **TypeScript**
- **Tailwind CSS v4** with shadcn/ui components


### Backend & Database

- **Supabase** (PostgreSQL database)
- **Supabase Auth** (Email/password authentication)
- **Server Actions** for form handling


### AI & Monitoring

- **TensorFlow.js** with BlazeFace model for real-time face detection
- **MediaPipe** or custom ML models for posture detection
- **WebRTC** for camera access


### Email

- **Nodemailer** for sending emails (welcome, verification, password reset)


---

## Key Features Implemented

### 1. Authentication System

- **Registration:** Email/password signup with email verification
- **Login:** Secure authentication with session management
- **Password Reset:** Email-based password recovery
- **Protected Routes:** Dashboard and course pages require authentication
- **Middleware:** Token refresh and session validation


**Files:**

- `app/auth/login/page.tsx`
- `app/auth/register/page.tsx`
- `app/actions/auth.ts`
- `middleware.ts`
- `lib/supabase/client.ts`, `lib/supabase/server.ts`


### 2. AI-Powered Video Monitoring

**Real-time Face Detection:**

- Detects if student's face is visible in webcam
- Tracks attention status (Focused/Not Focused)
- Video auto-pauses if face not detected for 25+ seconds


**Posture Monitoring:**

- Analyzes student posture (Good/Poor/Slouching)
- Real-time feedback displayed during video lessons


**Session Activity Tracking:**

- Logs when students leave the page/switch tabs
- Tracks total active watch time vs. idle time
- Affects progress completion requirements


**Files:**

- `components/video-player-monitored.tsx`
- `lib/face-detection.ts`
- `scripts/setup-video-tracking.sql`


### 3. Course Structure

**Course Data (`lib/courses-data.ts`):**

- Course: "Web Development - Beginner"
- 5 Modules (HTML, CSS, JavaScript, React, Node.js)
- Each module contains:

- 5 video lessons (YouTube embedded)
- 20 MCQ questions
- 2 coding challenges





**Video Progress Tracking:**

- Saves watch time every 10 seconds
- Marks video as complete when 90% watched
- Links to `video_progress` table in Supabase


### 4. Quiz System

**Multiple Choice Questions (MCQ):**

- 20 questions per module
- 10-minute auto-submit timer
- Visual feedback for selected answers (border + background highlight)
- Shows score and results after submission
- One attempt only - locked after submission


**Coding Challenges:**

- 2 coding questions per module (10 marks each)
- 20-minute auto-submit timer per question
- Multi-language support (JavaScript, Python, Java, C++)
- Code editor with syntax highlighting
- Test case validation (prevents empty/trivial code submissions)
- Minimum 50 characters of actual code required
- One attempt only - locked after submission


**Quiz Unlocking Logic:**

- Complete 1 video → Unlock Quiz Set 1 (MCQ + Coding Q1 + Coding Q2)
- Each module has independent quiz sets
- Must finish all quizzes to move to next module


**Files:**

- `app/courses/[courseId]/module/[moduleNumber]/quiz/page.tsx`
- `app/courses/[courseId]/module/[moduleNumber]/quiz/coding/[questionNumber]/page.tsx`
- `scripts/setup-quiz-tables.sql`


### 5. Dashboard

**Real-Time Monitoring Status:**

- Posture indicator (Good/Poor/Slouching)
- Focus status (Focused/Distracted)
- Face detection (Active/Not Detected)
- Live camera preview
- Start/Stop monitoring controls


**Course Progress:**

- Shows all enrolled courses
- Displays completed videos by course
- Progress percentage per course
- Links to continue learning


**Quiz Sets:**

- Lists available quiz sets
- Shows locked/unlocked status
- Displays completion status
- Direct links to start quizzes


**Files:**

- `app/dashboard/page.tsx`


### 6. Database Schema

**Tables Created:**

```sql
-- User profiles (extends Supabase auth.users)
CREATE TABLE profiles (
  id UUID PRIMARY KEY REFERENCES auth.users(id),
  email TEXT UNIQUE NOT NULL,
  full_name TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Video watch progress
CREATE TABLE video_progress (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES profiles(id),
  course_id TEXT NOT NULL,
  module_number INTEGER NOT NULL,
  video_id TEXT NOT NULL,
  watch_time INTEGER DEFAULT 0,
  total_duration INTEGER NOT NULL,
  completed BOOLEAN DEFAULT FALSE,
  last_watched TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, video_id)
);

-- Course enrollment and progress
CREATE TABLE course_progress (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES profiles(id),
  course_id TEXT NOT NULL,
  enrolled_at TIMESTAMP DEFAULT NOW(),
  last_accessed TIMESTAMP DEFAULT NOW(),
  completed BOOLEAN DEFAULT FALSE,
  UNIQUE(user_id, course_id)
);

-- Monitoring session logs
CREATE TABLE monitoring_sessions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES profiles(id),
  course_id TEXT NOT NULL,
  module_number INTEGER NOT NULL,
  started_at TIMESTAMP DEFAULT NOW(),
  ended_at TIMESTAMP,
  total_duration INTEGER DEFAULT 0,
  face_detected_duration INTEGER DEFAULT 0,
  attention_score FLOAT,
  posture_events JSONB
);

-- Quiz results (MCQ)
CREATE TABLE quiz_results (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES profiles(id),
  course_id TEXT NOT NULL,
  module_number INTEGER NOT NULL,
  quiz_type TEXT DEFAULT 'mcq',
  score INTEGER NOT NULL,
  total_questions INTEGER NOT NULL,
  answers JSONB,
  submitted_at TIMESTAMP DEFAULT NOW(),
  time_taken INTEGER,
  UNIQUE(user_id, course_id, module_number, quiz_type)
);

-- Coding challenge submissions
CREATE TABLE coding_submissions (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES profiles(id),
  course_id TEXT NOT NULL,
  module_number INTEGER NOT NULL,
  question_number INTEGER NOT NULL,
  code TEXT NOT NULL,
  language TEXT NOT NULL,
  test_results JSONB,
  score INTEGER NOT NULL,
  submitted_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, course_id, module_number, question_number)
);
```

**Files:**

- `scripts/setup-video-tracking.sql`
- `scripts/setup-quiz-tables.sql`


---

## Major Fixes & Improvements

### Build & Deployment Fixes

1. ✅ Removed `@import "tw-animate-css"` causing CSS validation errors
2. ✅ Fixed template literal escaping in `data/study-materials.tsx`
3. ✅ Removed `export const runtime = "nodejs"` from server action files (Next.js 16 compatibility)
4. ✅ Fixed async `params` handling in all page components (Next.js 16 requirement)
5. ✅ Removed v0 branding, logos, and debug log prefixes


### Quiz System Fixes

1. ✅ Expanded MCQ from 5 to 20 questions per module
2. ✅ Added 2 coding questions per module (was only 1)
3. ✅ Implemented 10-minute timer for MCQ (auto-submit)
4. ✅ Implemented 20-minute timer for coding questions (auto-submit)
5. ✅ Added validation to prevent empty code submissions
6. ✅ Added visual selection feedback for MCQ (border + background color)
7. ✅ Locked quizzes after submission (no retakes)
8. ✅ Fixed test case validation (no longer passes garbage code)


### Video & Progress Fixes

1. ✅ Fixed dashboard not showing completed videos
2. ✅ Fixed quiz sets not unlocking after video completion
3. ✅ Added 90% completion threshold for videos
4. ✅ Fixed course progress calculation
5. ✅ Fixed `/courses/[courseId]` 404 error (redirect to module 1)


### Authentication Fixes

1. ✅ Fixed Supabase client initialization errors
2. ✅ Added proper error handling for missing env variables
3. ✅ Fixed "Failed to fetch" errors in auth flow


---

## Environment Variables Required

```plaintext
# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
SUPABASE_JWT_SECRET=your_jwt_secret

# Database (Neon/Supabase Postgres)
POSTGRES_URL=your_postgres_url
POSTGRES_PRISMA_URL=your_prisma_url
POSTGRES_URL_NON_POOLING=your_non_pooling_url
POSTGRES_PASSWORD=your_password

# Email (Nodemailer)
EMAIL_USER=your_email@gmail.com
EMAIL_PASSWORD=your_app_password

# Development
NEXT_PUBLIC_DEV_SUPABASE_REDIRECT_URL=http://localhost:3000
```

---

## File Structure

```plaintext
├── app/
│   ├── auth/
│   │   ├── login/page.tsx
│   │   ├── register/page.tsx
│   │   └── callback/route.ts
│   ├── courses/
│   │   └── [courseId]/
│   │       ├── page.tsx (redirects to module 1)
│   │       └── module/
│   │           └── [moduleNumber]/
│   │               ├── page.tsx (video player)
│   │               └── quiz/
│   │                   ├── page.tsx (MCQ)
│   │                   └── coding/
│   │                       └── [questionNumber]/page.tsx
│   ├── dashboard/page.tsx
│   ├── actions/
│   │   └── auth.ts
│   └── layout.tsx
├── components/
│   ├── video-player-monitored.tsx
│   └── ui/ (shadcn components)
├── lib/
│   ├── courses-data.ts
│   ├── supabase/
│   │   ├── client.ts
│   │   ├── server.ts
│   │   └── admin.ts
│   └── face-detection.ts
├── data/
│   └── study-materials.tsx
├── scripts/
│   ├── setup-video-tracking.sql
│   └── setup-quiz-tables.sql
└── middleware.ts
```

---

## How It Works

### User Flow:

1. **Register** → Email verification sent
2. **Login** → Redirect to Dashboard
3. **Dashboard** → View course progress, start monitoring, see quiz status
4. **Select Course** → Choose "Web Development - Beginner"
5. **Module Page** → Watch video with AI monitoring active
6. **Complete Video** → 90% watched = video marked complete
7. **Quiz Unlocked** → Quiz Set 1 available after completing first video
8. **Take Quiz** → Complete MCQ (10 min) and Coding (20 min each)
9. **View Results** → See scores, locked from retaking
10. **Progress to Next Module** → Repeat for modules 2-5


### AI Monitoring Flow:

1. User clicks "Start Monitoring" on dashboard or module page
2. Requests camera permission
3. Loads TensorFlow.js + BlazeFace model
4. Real-time face detection every 100ms
5. Analyzes posture and attention
6. Pauses video if face not detected for 25+ seconds
7. Logs all monitoring data to `monitoring_sessions` table


---

## Known Limitations & Future Enhancements

**Current Limitations:**

- Coding test cases are simplified (not running actual code execution)
- Face detection requires good lighting
- No admin panel for managing courses/users
- No certificate generation after course completion
- No peer-to-peer features (forums, discussions)


**Recommended Enhancements:**

- Add admin dashboard for course management
- Implement real code execution sandbox for coding challenges
- Add discussion forums per module
- Generate certificates on course completion
- Add more courses and subjects
- Implement payment/subscription system
- Add mobile app support
- Enhanced analytics and reporting


---

## Deployment Checklist

- Build errors fixed
- Environment variables configured
- Supabase database set up with all tables
- SQL migration scripts executed
- Authentication flow tested
- Video monitoring tested
- Quiz system tested
- Production URL working
- Email delivery configured

## Theme & Style Summary

**Theme Name:** **shadcn/ui Default Dark Theme** (with neutral color palette)

### Design System Details:

| Category | Value
|-----|-----
| **UI Framework** | shadcn/ui + Tailwind CSS v4
| **Color System** | OKLCH color space (modern perceptual uniformity)
| **Base Theme** | Dark mode by default
| **Color Palette** | Neutral/Grayscale (no accent color - pure black/white/gray)
| **Typography** | Geist Sans (body) + Geist Mono (code)
| **Border Radius** | 0.625rem (10px) - slightly rounded
| **Animations** | tw-animate-css


### Color Scheme:

| Token | Light Mode | Dark Mode
|-----|-----
| **Background** | `oklch(0.145 0 0)` - Near black | `oklch(0.145 0 0)` - Near black
| **Foreground** | `oklch(0.985 0 0)` - Near white | `oklch(0.985 0 0)` - Near white
| **Primary** | `oklch(0.205 0 0)` - Dark gray | `oklch(0.985 0 0)` - Near white
| **Secondary** | `oklch(0.97 0 0)` - Light gray | `oklch(0.269 0 0)` - Dark gray
| **Muted** | `oklch(0.97 0 0)` - Light gray | `oklch(0.269 0 0)` - Dark gray
| **Destructive** | `oklch(0.577 0.245 27.325)` - Red | `oklch(0.396 0.141 25.723)` - Dark red
| **Border** | `oklch(0.922 0 0)` - Light border | `oklch(0.269 0 0)` - Dark border


### Style Characteristics:

- **Minimalist dark theme** with high contrast
- **Neutral monochromatic** palette (no brand colors)
- **Clean, modern aesthetic** with subtle borders
- **Professional/technical** look suitable for learning platforms


This is essentially the **shadcn/ui "New York" style variant** with a **neutral/zinc color base** in permanent dark mode.


[10:33 am, 18/11/2025] Mega IT Clg: 1)Register page
----username
-----password
-----mobile number
2)Login
---->login credentials(username,password)
---->authenticate user(whether registered or not)
[10:35 am, 18/11/2025] Mega IT Clg: 3)Dashboard
----> shows navigation buttons (Search Content, Quizzes, Alerts, Reports)
----> displays real-time posture status (Good posture / Leaning forward)
----> displays real-time attention status (Focused / Distracted)
[10:36 am, 18/11/2025] Mega IT Clg: 4.)Content / Lecture Viewing Page
Displays study materials (text, images, video links)
Shows real-time posture/attention alerts on the same page
Allows user to move to the quiz
[10:38 am, 18/11/2025] Mega IT Clg: 5)Quiz Page

----> displays multiple-choice or true/false questions
----> records answers and stores temporary score in the browser
----> shows quiz result instantly after submission
----> gives suggestion to review content if the score is low